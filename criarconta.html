<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tecauto • Criar Conta</title>
    <link rel="stylesheet" href="styles/fonts.css">
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
    <button class="toggle-dark-mode" aria-label="Alternar modo escuro">
        <i class="fas fa-sun"></i>
    </button>

    <header>
        <div class="header-container">
            <div class="logo">
                <img src="imagens/Logo Tecauto Azul - Laranja Png-07-07.png" alt="Tecauto Logo">
            </div>
            <nav class="menu">
                <ul>
                    <li><a href="index.html">Início</a></li>
                    <li><a href="servicos.html">Serviços</a></li>
                    <li><a href="sobre.html">Sobre</a></li>
                    <li><a href="contactos.html">Contacto</a></li>
                    <li><a href="horario.html">Horário</a></li>
                    <li><a href="criarconta.html" class="active">Criar Conta</a></li>
                </ul>
            </nav>
            <div class="login">
                <a href="login.html">Fazer Login</a>
            </div>
        </div>
    </header>

    <main>
        <section id="criar-conta" class="fade-in">
            <h2>Criar Conta</h2>
            <form class="form-modern" id="createAccountForm">
                <div class="form-group">
                    <input type="text" id="nome" name="nome" required>
                    <label for="nome">Nome completo</label>
                    <span class="error" id="nomeError"></span>
                </div>
                <div class="form-group">
                    <input type="email" id="email" name="email" required>
                    <label for="email">Email</label>
                    <span class="error" id="emailError"></span>
                </div>
                <div class="form-group">
                    <input type="password" id="password" name="password" required>
                    <label for="password">Senha</label>
                    <span class="error" id="passwordError"></span>
                </div>
                <div class="form-group">
                    <input type="password" id="confirmPassword" name="confirmPassword" required>
                    <label for="confirmPassword">Confirmar senha</label>
                    <span class="error" id="confirmPasswordError"></span>
                </div>
                <input type="submit" value="Criar Conta">
                <p class="form-message"></p>
            </form>
        </section>
    </main>

    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <h3>Contato</h3>
                <p>Email: <a href="mailto:tecautooficial@gmail.com">tecautooficial@gmail.com</a></p>
                <p>Telefone: <a href="tel:+258840203487">+258 84 020 3487</a></p>
                <p>Maxaquene, Maputo, Moçambique</p>
            </div>
            <div class="footer-section">
                <h3>Links Úteis</h3>
                <a href="index.html">Início</a><br>
                <a href="servicos.html">Serviços</a><br>
                <a href="contactos.html">Contato</a><br>
                <a href="sobre.html">Sobre Nós</a>
            </div>
            <div class="footer-section">
                <h3>Redes Sociais</h3>
                <div class="footer-social">
                    <a href="https://www.facebook.com/share/15yyKTsxhR/" target="_blank"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://x.com/tecautooficial?t=W4VG_b4m9mwdDBjrFe_ZtQ&s=09" target="_blank"><i class="fab fa-twitter"></i></a>
                    <a href="https://www.instagram.com/tecautooficial/" target="_blank"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.linkedin.com/in/tec-auto-55a789377?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 Tecauto • Todos os direitos reservados | Desenvolvido pela <a href="#" target="_blank">Tecauto</a></p>
        </div>
    </footer>

    <a href="https://wa.me/258840203487" class="whatsapp-float" target="_blank"><i class="fab fa-whatsapp"></i></a>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const toggleButton = document.querySelector('.toggle-dark-mode');
            const toggleIcon = toggleButton.querySelector('i');

            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
                toggleIcon.classList.replace('fa-sun', 'fa-moon');
            }

            toggleButton.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                const isDarkMode = document.body.classList.contains('dark-mode');
                localStorage.setItem('darkMode', isDarkMode);
                toggleIcon.classList.toggle('fa-sun', !isDarkMode);
                toggleIcon.classList.toggle('fa-moon', isDarkMode);
            });

            const form = document.getElementById('createAccountForm');
            const formMessage = document.querySelector('.form-message');
            const nome = document.getElementById('nome');
            const email = document.getElementById('email');
            const password = document.getElementById('password');
            const confirmPassword = document.getElementById('confirmPassword');
            const nomeError = document.getElementById('nomeError');
            const emailError = document.getElementById('emailError');
            const passwordError = document.getElementById('passwordError');
            const confirmPasswordError = document.getElementById('confirmPasswordError');

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                nomeError.textContent = '';
                emailError.textContent = '';
                passwordError.textContent = '';
                confirmPasswordError.textContent = '';
                formMessage.textContent = '';

                let isValid = true;

                if (nome.value.trim().length < 2) {
                    nomeError.textContent = 'O nome deve ter pelo menos 2 caracteres';
                    isValid = false;
                }

                if (!email.value.includes('@') || !email.value.includes('.')) {
                    emailError.textContent = 'Por favor, insira um email válido';
                    isValid = false;
                }

                if (password.value.length < 6) {
                    passwordError.textContent = 'A senha deve ter pelo menos 6 caracteres';
                    isValid = false;
                }

                if (password.value !== confirmPassword.value) {
                    confirmPasswordError.textContent = 'As senhas não coincidem';
                    isValid = false;
                }

               
                try {
                    const response = await fetch('https://amusing-ambition-production.up.railway.app/api/criarUsuario', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ nome: nome.value, email: email.value, senha: password.value})
                    });

                    const data = await response.json();

                    if (response.ok) {
                        // Guardando token no localStorage
                        localStorage.setItem('token', data.token);
                        console.log(email);
                        if (email.value == "tecauto@gmail.com"){
                            location.replace('remodelacoestecauto/admin_dashboard.html');
                        } else {
                            location.replace('remodelacoestecauto/client_dashboard.html');
                        }
                        form.reset();
                    } else {
                        formMessage.textContent = data.error || 'Erro no login';
                        formMessage.style.color = 'red';
                    }
                } catch (err) {
                    console.error(err);
                    formMessage.textContent = 'Erro de conexão com o servidor';
                    formMessage.style.color = 'red';
                }
            });

            const fadeElements = document.querySelectorAll('.fade-in');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.2 });

            fadeElements.forEach(el => observer.observe(el));
        });
    </script>
</body>
</html>